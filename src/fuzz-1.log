INFO: Seed: 2739687791
INFO: Loaded 1 modules   (249 inline 8-bit counters): 249 [0x798470, 0x798569), 
INFO: Loaded 1 PC tables (249 PCs): 249 [0x573678,0x574608), 
INFO:       16 files found in ../seeds
INFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4096 bytes
INFO: seed corpus: files: 16 min: 276b max: 4096b total: 23776b rss: 37Mb

=================================================================
==7293==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 272 byte(s) in 1 object(s) allocated from:
    #0 0x512300 in __interceptor_malloc (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x512300)
    #1 0x556232 in store_idat_plte /home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/pngparser.c:999:35
    #2 0x557443 in store_png_palette /home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/pngparser.c:1070:5
    #3 0x55778e in store_png /home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/pngparser.c:1093:9
    #4 0x54ad45 in LLVMFuzzerTestOneInput /home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette.c:32:3
    #5 0x42ec17 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x42ec17)
    #6 0x437310 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x437310)
    #7 0x438916 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x438916)
    #8 0x43a9c2 in fuzzer::Fuzzer::Loop(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x43a9c2)
    #9 0x429eac in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x429eac)
    #10 0x41cd72 in main (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x41cd72)
    #11 0x7fd2f4983b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

Direct leak of 14 byte(s) in 1 object(s) allocated from:
    #0 0x512780 in realloc (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x512780)
    #1 0x554844 in compress_png_data /home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/pngparser.c:918:28
    #2 0x556872 in store_idat_plte /home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/pngparser.c:1018:5
    #3 0x557443 in store_png_palette /home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/pngparser.c:1070:5
    #4 0x55778e in store_png /home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/pngparser.c:1093:9
    #5 0x54ad45 in LLVMFuzzerTestOneInput /home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette.c:32:3
    #6 0x42ec17 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x42ec17)
    #7 0x437310 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x437310)
    #8 0x438916 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x438916)
    #9 0x43a9c2 in fuzzer::Fuzzer::Loop(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x43a9c2)
    #10 0x429eac in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x429eac)
    #11 0x41cd72 in main (/home/alessandro/Downloads/college/Software_Security/lab0x04fuzzer/src/fuzzer_store_png_palette+0x41cd72)
    #12 0x7fd2f4983b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

SUMMARY: AddressSanitizer: 286 byte(s) leaked in 2 allocation(s).

INFO: a leak has been found in the initial corpus.

INFO: to ignore leaks on libFuzzer side use -detect_leaks=0.

MS: 0 ; base unit: 0000000000000000000000000000000000000000
artifact_prefix='./'; Test unit written to ./leak-349bf44daad3e25bc75bc02386562e700a6cd2ca
