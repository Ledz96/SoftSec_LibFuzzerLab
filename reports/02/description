iend is never freed after allocation, nor it is checked if it's allocated twice
